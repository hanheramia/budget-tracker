<h2>Add Salary / Bonus</h2>

<form (ngSubmit)="addSalary()" class="salary-form">

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Type</mat-label>
    <mat-select [(ngModel)]="newSalary.type" name="type">
      <mat-option value="Salary">Salary</mat-option>
      <mat-option value="Bonus">Bonus</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Description</mat-label>
    <input matInput [(ngModel)]="newSalary.description" name="description" />
  </mat-form-field>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Amount</mat-label>
    <input matInput type="number" [(ngModel)]="newSalary.amount" name="amount" min="0" step="0.01" required />
  </mat-form-field>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Months</mat-label>
    <input matInput type="number" [(ngModel)]="newSalary.months" name="months" min="1" required />
  </mat-form-field>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Start Month</mat-label>
    <input matInput [matDatepicker]="monthPicker" [(ngModel)]="newSalary.startMonthDate" name="startMonth" required readonly />
    <mat-datepicker-toggle matSuffix [for]="monthPicker"></mat-datepicker-toggle>
    <mat-datepicker #monthPicker startView="multi-year" (monthSelected)="chosenMonthHandler($event, monthPicker)"></mat-datepicker>
  </mat-form-field>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Due Date</mat-label>
    <mat-select [(ngModel)]="newSalary.dueDate" name="dueDate">
      <mat-option value="15">15th</mat-option>
      <mat-option value="30">30th</mat-option>
    </mat-select>
  </mat-form-field>

  <div class="buttons">
    <button mat-raised-button color="primary" type="submit">Add</button>
    <button mat-raised-button color="warn" type="button" (click)="clearAll()">Clear All</button>
  </div>
</form>

<hr />

<h3>Salary Schedule</h3>
<div *ngIf="salaryService.salaries$ | async as salaries; else noSalary">
  <div class="table-wrapper">
    <div class="table-scroll-container">
      <table mat-table [dataSource]="salaries" class="mat-elevation-z8 table-fixed">

        <!-- Type Column -->
        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef> Type </th>
          <td mat-cell *matCellDef="let s"> {{ s.type }} </td>
        </ng-container>

        <!-- Description Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef> Description </th>
          <td mat-cell *matCellDef="let s"> {{ s.description }} </td>
        </ng-container>

        <!-- Amount Column -->
        <ng-container matColumnDef="amount">
          <th mat-header-cell *matHeaderCellDef> Amount </th>
          <td mat-cell *matCellDef="let s"> {{ s.amount | number:'1.2-2' }} </td>
        </ng-container>

        <!-- Months Column -->
        <ng-container matColumnDef="months">
          <th mat-header-cell *matHeaderCellDef> Months </th>
          <td mat-cell *matCellDef="let s"> {{ s.months }} </td>
        </ng-container>

        <!-- Start Month Column -->
        <ng-container matColumnDef="startMonth">
          <th mat-header-cell *matHeaderCellDef> Start Month </th>
          <td mat-cell *matCellDef="let s"> {{ s.startMonth }} </td>
        </ng-container>

        <!-- Due Date Column -->
        <ng-container matColumnDef="dueDate">
          <th mat-header-cell *matHeaderCellDef> Due Date </th>
          <td mat-cell *matCellDef="let s"> {{ s.dueDate }} </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let s">
            <button mat-mini-button color="warn" (click)="removeSalary(s)">Remove</button>
          </td>
        </ng-container>
        
        <!-- Header / Row -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </div>
</div>

<ng-template #noSalary>
  <p>No salary records found.</p>
</ng-template>


<ng-template #noSalary>
  <p>No salary or bonus entries yet.</p>
</ng-template>
